"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const vitest_1 = require("vitest");
const mock_1 = require("./mock");
(0, vitest_1.describe)('brregAnalyze', () => {
    let companies;
    let roles;
    (0, vitest_1.beforeAll)(() => {
        companies = (0, mock_1.getCompanies)(100);
        roles = (0, mock_1.getRoles)(companies);
    });
    (0, vitest_1.it)('should analyze data', () => {
        (0, vitest_1.expect)(companies).to.be.a('map');
        (0, vitest_1.expect)(roles).to.be.a('map');
        (0, vitest_1.expect)(roles.size).to.be.greaterThanOrEqual(100);
        roles.forEach(role => {
            (0, vitest_1.expect)(role).to.be.an('array');
        });
        const regn = {};
        companies.forEach(company => {
            const currentRoles = roles.get(company.organisasjonsnummer);
            if (!currentRoles || currentRoles.length === 0)
                return;
            let accountant;
            const regns = currentRoles.filter(r => r.type.kode === 'REGN').map(regn => regn.roller.filter(r => r.fratraadt === false && r.type.kode === 'REGN' && r.enhet?.erSlettet === false)).flat();
            if (regns.length > 0)
                accountant = regns.sort((a, b) => a.rekkefolge - b.rekkefolge)[0].enhet;
            if (!accountant)
                return;
            if (!regn[accountant.organisasjonsnummer])
                regn[accountant.organisasjonsnummer] = { '0-9': 0, '10-19': 0, '20-49': 0, '50-99': 0, '100-249': 0, '250+': 0, 'total': 0 };
            regn[accountant.organisasjonsnummer].total++;
            const numberOfEmployees = company.antallAnsatte;
            if (numberOfEmployees < 10)
                regn[accountant.organisasjonsnummer]['0-9']++;
            else if (numberOfEmployees < 20)
                regn[accountant.organisasjonsnummer]['10-19']++;
            else if (numberOfEmployees < 50)
                regn[accountant.organisasjonsnummer]['20-49']++;
            else if (numberOfEmployees < 100)
                regn[accountant.organisasjonsnummer]['50-99']++;
            else if (numberOfEmployees < 250)
                regn[accountant.organisasjonsnummer]['100-249']++;
            else
                regn[accountant.organisasjonsnummer]['250+']++;
        });
        console.log(regn);
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYnJyZWdBbmFseXplLnRlc3QuanMiLCJzb3VyY2VSb290IjoiLi9zcmMvIiwic291cmNlcyI6WyJzcmMvdGVzdC9icnJlZ0FuYWx5emUudGVzdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLG1DQUF3RDtBQUV4RCxpQ0FBK0M7QUFHL0MsSUFBQSxpQkFBUSxFQUFDLGNBQWMsRUFBRSxHQUFHLEVBQUU7SUFDMUIsSUFBSSxTQUFpQyxDQUFBO0lBQ3JDLElBQUksS0FBNEIsQ0FBQTtJQUVoQyxJQUFBLGtCQUFTLEVBQUMsR0FBRyxFQUFFO1FBQ1gsU0FBUyxHQUFHLElBQUEsbUJBQVksRUFBQyxHQUFHLENBQUMsQ0FBQTtRQUM3QixLQUFLLEdBQUcsSUFBQSxlQUFRLEVBQUMsU0FBUyxDQUFDLENBQUE7SUFDL0IsQ0FBQyxDQUFDLENBQUE7SUFFRixJQUFBLFdBQUUsRUFBQyxxQkFBcUIsRUFBRSxHQUFHLEVBQUU7UUFDM0IsSUFBQSxlQUFNLEVBQUMsU0FBUyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUE7UUFDaEMsSUFBQSxlQUFNLEVBQUMsS0FBSyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUE7UUFDNUIsSUFBQSxlQUFNLEVBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsa0JBQWtCLENBQUMsR0FBRyxDQUFDLENBQUE7UUFDaEQsS0FBSyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsRUFBRTtZQUNqQixJQUFBLGVBQU0sRUFBQyxJQUFJLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxPQUFPLENBQUMsQ0FBQTtRQUNsQyxDQUFDLENBQUMsQ0FBQTtRQUNGLE1BQU0sSUFBSSxHQVdOLEVBQUUsQ0FBQTtRQUVOLFNBQVMsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLEVBQUU7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